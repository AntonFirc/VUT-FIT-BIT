<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-2"/>
    <title>Projekt IIS</title>
    <style type="text/css">
        table { border-collapse: collapse; }
        td, th { border: 1px solid black; padding: 0.3em 0.5em; text-align: left; }
        dt { font-weight: bold; margin-top: 0.5em; }
    </style>
</head>
<body>

<!-- Zkontrolujte prosím nastavení kódování v hlavièce dokumentu 
     podle pou¾itého editoru -->

<h1>Øetìzec multikin</h1> <!-- Nahradte názvem svého zadání -->

<dl>
    <dt>Autoøi</dt>
    <dd>Ondøej Deingruber <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
        <a href="mailto:xdeing00@stud.fit.vutbr.cz">xdeing00@stud.fit.vutbr.cz</a> -
        správa u¾ivatelù, tr¾by, ru¹ení rezervací
    </dd>
    <dd>Anton Firc <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
        <a href="mailto:xfirca00@stud.fit.vutbr.cz">xfirca00@stud.fit.vutbr.cz</a> -
        databázový subsystém, zobrazení projekcí, rezervace, prodej
    </dd>
    <dt>URL aplikace</dt>
    <dd><a href="http://www.stud.fit.vutbr.cz/~xfirca00/IIS" target="_blank">http://www.stud.fit.vutbr.cz/~xfirca00/IIS</a></dd>
</dl>

<h2>U¾ivatelé systému pro testování</h2>
<p>Uveïte prosím existující zástupce <strong>v¹ech rolí u¾ivatelù</strong>.</p>
<table>
    <tr><th>Login</th><th>Heslo</th><th>Role</th></tr>
    <tr><td>admin</td><td>admin123</td><td>Administrátor (admin)</td></tr>
    <tr><td>prodavac</td><td>prodavac123</td><td>Prodavaè (cashier)</td></tr>
    <tr><td>uzivatel</td><td>uzivatel123</td><td>Zákazník (user)</td></tr>
</table>

<h2>Implementace</h2>
<h3 style="margin-left: 20px;">Prohlí¾ení a vyhledávaní projekcí</h3>
<p style="margin-left: 40px;"><b>Skript:</b> <a href="index.php72" target="_blank">index.php72</a></p>
<p style="margin-left: 40px;">Najprv získa v¹etky názvy, ¾ánry, premietacie èasy a ceny vstupeniek filmov ktoré majú priradené premietanie. Tieto dáta sú pou¾ité pre vytvorenie mo¾ností filtrovania projekcií = filtrov.
Následne sú z databázy získané v¹etky premietania filmov, a vypísané do tabuµky v ktorej je mo¾né výsledky filtrova» podµa názvu, ¾ánru, èasu premietania a ceny vstupeniek.
Filtrovanie obsluhuje javascript spustený zmenou hodnoty niektorého filtra. Názov filmu odkazuje na vyskakovacie okno ktoré obsahuje popis filmu. Ku ka¾dej projekcii
je priradený odkaz na stránku rezervácie, ktorý do URL vlo¾í premennú s ID projekcie. Pokiaµ si zoznam filmov prehliada zamestnanec kina, vidí navy¹e odkaz na predaj lístku na premietanie.
Oskaz na predaj lístkov odkazuje na inú podstránku, inak funguje toto¾ne s odkazom na rezerváciu.
    Zobrazuje v¹etky filmy ktoré majú priradenú projekciu. Poskytuje mo¾nos» filtrova» projekcie podµa názvu filmu, èasu premietania, ¾ánru a ceny lístka.</p>

<h3 style="margin-left: 20px;">Rezervování konkrétnych miest</h3>
<p style="margin-left: 40px;"><b>Skript:</b> <a href="reservation.php72" target="_blank">reservation.php72</a></p>
<p style="margin-left: 40px;">Z databázy získa v¹etky rezervované sedadlá pre premietanie (ID dané argumentom v URL) a zobrazí "seat picker". Seat picker je tvorený
maticou check-boxov (pre zjednodu¹enie má ka¾dá sála 5 radov po 10 sedadiel), ka¾dý má priradené ID podµa oznaèenia radu a èísla sedadla. V¹etky u¾ rezervované sedadlá sú v stave "disabled", èo umo¾nuje oznaèenie
a rezerváciu iba e¹te nerezervovaných sedadiel. Po kliknutí na tlaèítko "Rezervovat", vlo¾ený javascript získa ID v¹etkých oznaèených sedadiel,
skontroluje èi sa poèet oznaèených sedadiel rovná zvolenému poètu lístkov a neprekraèuje maximálny poèet lístkov pre predaj cez internet 6(vymyslená hodnota, má zabráni» naru¹eniu behu systému falo¹nými rezerváciami). Následne je metódou POST zavolaný php skript callme.php72 ktorý ka¾dé jedno rezervované sedadlo vlo¾í do databázy. Po úspe¹nej rezervácii v¹etkých sedadiel je vypísaná hlá¹ka informujúca u¾ívateµa o úspechu.</p>

<h3 style="margin-left: 20px;">Zru¹i» star¹iu rezerváciu</h3>
<p style="margin-left: 40px;"><b>Skript:</b> <a href="user_reservations.php72" target="_blank">user_reservations.php72</a></p>
<p style="margin-left: 40px;">Získa z databázy v¹etky rezervácie s ID u¾ívateµa ktorý je práve prihlásený a vypí¹e ich. U¾ívateµ oznaèí z vypísaných rezervácií v¹etky ktoré chce zru¹i», javascript následne získa ID ka¾dej rezervácie a metódou POST zavolá php skript cancel_reservation.php72. Po úspe¹nom vymazaní rezervácii z databázy je vypísaná hlá¹ka informujúca u¾ívateµa o úspechu.</p>
<p style="margin-left: 40px;"><b>Skript:</b> <a href="manage_reservations.php72" target="_blank">manage_reservations.php72</a></p>
<p style="margin-left: 40px;">Prístupné len pracovníkom kina. Získa z databázy v¹etkých u¾ívateµov, a ka¾dého meno a login vlo¾i do "select-u" v ktorom je mo¾né vyhµadáva» písaním èasti mena alebo loginu.
Vyhµadávanie je implementované v javascripte. Po zvolení u¾ívateµa a kliknutí na tlaèidlo "Vypsat rezervace" získa z databázy v¹etky rezervácie ktoré spravil daný u¾ívateµ, a vypí¹e ich. Ru¹enie rezervácií je následne mo¾né rovanko ako v skripte user_reservations.php72.</p>

<h3 style="margin-left: 20px;">Predaj vstupenky</h3>
<p style="margin-left: 40px;"><b>Skript:</b> <a href="sale.php72" target="_blank">sale.php72</a></p>
<p style="margin-left: 40px;">Získa argument z URL, urèujúci ID premietania na ktoré budú predané lístky. Získa z databázy zoznam v¹etkých rezervovaných a nezaplatených sedadiel. Následne zobrazí "seat picker", po oznaèení zaplatených miest a kliknutí na tlaèítko "Prodat zvolená místa" sú pomocou javascriptu získané ID v¹etkých oznaèených sedadiel a pre ka¾dé sú metódou POST odoslané detaily skriptu set_paid.php72. Tento skript získa dáta a následne aktualizuje rezerváciu.</p>

<h3 style="margin-left: 20px;">Zistenie tr¾by kina/filmu</h3>
<p style="margin-left: 40px;"><b>Skript:</b> <a href="sales.php72" target="_blank">sales.php72</a></p>
<p style="margin-left: 40px;">Z databázy získa poèet v¹etkých predaných vstupeniek na jednotlivé filmy. Podµa poètu jednotlivých vstupeniek a cien vypoèíta doposiaµ celkovú tr¾bu ka¾dého filmu. Výsledky zapí¹e do tabuµky. Následne z databázy získa v¹etky kiná a ulo¾í ich údaje do poµa ktoré následne prechádza a pre ka¾dú lokalitu získa v¹etky poredané vstupenky. Podµa poètov predaných vstupeniek a cien vypoèíta tr¾by kina. Dáta z ka¾dého kina vypí¹e do tabuµky. Nakoniec sú v¹etky tr¾by zrátané a vypísaná celková tr¾ba v¹etkých kín.</p>


<h2>Instalace</h2>
<ul>
    <li>Po¾adovaná verzia PHP
        <ul>
            <li>7.2</li>
        </ul>
    </li>
    <li>Inicializácia databázy
        <ul>
            <li>Import database.sql na Vá¹ databázový server</li>
            <li>Nastavenie prístupových údajov do databázy v "config.php72"</li>
        </ul>
    </li>
    <li>Rozbalenie súborov
        <ul>
            <li>V¹etky php súbory je potrebné rozbali» do hlavného prieèinka.</li>
            <li>Prvé prihlásenie pomocou mena "admin" a hesla "admin123".</li>
        </ul>
    </li>
</ul>

<h2>Známé problémy</h2>
<p>Problémy so správnym kódovaním znakov s diakritikou pri vkladaní do databázy.</p>

</body>
</html>
